# LifeLib

![Logo](/doc/Logo.png)

## Описание

Статическая библиотека, реализующая модель "Жизни". Игра придумана английским математиком Джоном Конвеем в 1970 году. 
Представляет собой классический пример клеточных автоматов и считается полной по Тьюрингу.

## Содержание

* [Правила](#правила)
* [Обзор](#обзор)
* [Сборка](#сборка)
* [BenchMark](#benchmark)
* [Тесты](#тесты)
* [Документация](#документация)

## Обзор

В модели доступны три вида расчета нового состояния:

* Common  
Однопоточный расчет.
* OpenMP  
Многопоточный расчет, реализуемый с помощью библиотеки OpenMP.
* Thread  
Многопоточный расчет, реализуемый с помощью std::thread.

По умолчанию вместе с тестами собирается консольное приложение MvcManualTest, которое демонстрирует основные возможности и ход игры:

![ManualTest](/doc/ManualTest.png)

### Правила

Правила развития достаточно просты. Место действия - размеченное на квадраты поле, замкнутое с двух сторон.
Каждая клетка на поле имеет восемь соседей и может находиться в двух состояниях: живая(клетка заполнена) и мертвая(клетка пуста).
Распределение клеток на поле до старта называется первым поколением, каждое следующее поколение рассчитывается согласно следующим условиям:
* В пустой клетке, соседями которой являются три живых клетки, зарождается жизнь.
* Если у живой клетки два или три живых соседа, клетка продолжает жить, в противном случае умирает.

### Подключение

Проект описывается с помощью CMake, поэтому для подключения библиотеки необходимо скопировать ее в рабочий каталог,  
включить в цепь сборки и пролинковать с новой целью:

    add_subdirectory(./lib/LifeLib)
    target_link_libraries(YourTarget PRIVATE LifeLib)
    
Дополнительно подключать каталог заголовочных файлов не нужно. 

## Сборка

Cистемные требования:

* Компилятор с поддержкой стандарта >= C++17
* Библиотека OpenMP (libomp)

При сборке с флагом -std=c++17 требуется отключить сборку тестов и benchmark в корневом CMakeLists.txt:

  option(TEST "Build tests" OFF)
  option(BENCHMARK "Build benchmark" OFF)
  
Сборка движка c OpenMP требует наличия соответствующей библиотеки, однако проект поддерживает условную компиляцию, при отсутствии
необходимых компонент сборка будет продолжена с исключением модулей недоступных для компиляции.

## BenchMark

Для сравнения производительности движков используется google benchmark. (/src/benchmark)

Однопоточная реализация построена таким образом, чтобы хранить в памяти список активных клеток и пересчитывать изменения кадра
только в пределах области их расположения. Такой подход более эффективен в случае разреженной матрицы.  
Обе многопоточные реализации обрабатываю целиком все поле, в результате их преимущества заметны при плотном
заполнении матрицы. В Thread реализации используется пул потоков, что позволяет не тратить время на их пересоздание. 

![EngineBenchmark](/doc/EngineBenchmark.png)

Измерения представлены в порядке увеличения заполнения матрицы 1024x1024 фигурами типа stick(***).

## Тесты

Тестирование реализуется с помощью GTest и CTest. В каталоге /src/tests располагаются тесты основных компонентов библиотеки.
Управление их сборкой осуществляется переключением переменной TEST в корневом CMakeLists.txt.

    option(TEST "Build tests" ON)

При активации сборки тестов библиотека собирается с -fsanitize=address 

## Документация

Комментарии в коде соответствуют стилю Doxygen, более подробная документация может быть сгенерирована с помощью файла в разделе /doc.

    doxygen ./doc/Doxyfile

![Doc](/doc/Doc.png)
