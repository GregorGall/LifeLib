# LifeLib

![Logo](/resource/Logo.png)

## Описание

Статическая библиотека релизующая модель игры "Жизнь". Придуманна английским математиком Джоном Конвеем в 1970 году. 
Представляет собой классический пример клеточных автоматов и считается полной по Тьюрингу.

## Содержание

* [Правила](#правила)
* [Обзор](#обзор)
* [Сборка](#сборка)
* [BenchMark](#benchmark)
* [Тесты](#тесты)
* [Документация](#документация)

## Обзор

На текущий момент доступно три реализации движков:

* Common  
Однопоточный расчет нового состояния
* OpenMP
Многопоточный расчет, реализуемый с помощью библиотеки OpenMP
* Thread
Многопоточный расчет, реализуемый с помощью std::thread

По умолчанию вместе с тестами собирается консольное приложение MvcManualTest, которое демонстрирует основные возможности и ход игры:

![ManualTest](/resource/ManualTest.png)

### Правила

Правила развития достаточно просты. Место действия - размеченное на квадраты поле, замкнутое с двух сторон.
Каждая клетка на поле имеет восемь соседей и может находиться в двух состояних: живая(клетка заполнена) и мертвая(клетка пуста).
Распределение клеток на поле до старта называется первым поколением, каждое следующее поколение рассчитывается согласно следующим условиям:
* В пустой клетке, соседями которой являются три живых клетки, зарождается жизнь.
* Если у живой клетки два или три живых соседа, клетка продолжает жить, в противном случае умирает.

### Подключение

Для описания проекта используется CMake, поэтому для подключения библиотеки необходимо скопировать ее в каталог нового проекта,  
добавить как подкаталог и пролинковать с новой целью:

    add_subdirectory(./lib/LifeLib)
    target_link_libraries(YourTarget PRIVATE LifeLib)
    
Дополнительно подключать каталог заголовочных файлов не нужно. 

## Сборка

Для сборки требуется компилятор с поддержкой стандарта не ниже C++17. Сборка с поддержкой OpenMp требует наличия соответствующей
библиотеки. Проект поддерживает условную компиляцию. При отсутствии нужных компонентов сборка будет продолжена с отключением
соответствующих движков.

Подходящее окружение может быть собрано из /docker/Dockerfile

## BenchMark

Для сравнения производительности движков используется google benchmark. (/src/benchmark)

Однопоточная реализация построена таким образом, чтобы хранить в памяти список активных клеток и пересчитывать изменения кадра
только в пределах области их расположения. Такой подход более эффективен в случае разреженной матрицы.  
Обе многопоточные реализации обрабатываю целиком все поле на каждой иттерации, в результате их преимущества заметны при плотном
заполнении матрицы. В Thread реализации используется пул потоков, что позволяет не тратить время на их пересоздание. 

![EngineBenchmark](/resource/EngineBenchmark.png)

Измерения представлены в порядке увеличения заполнения матрицы 1024x1024 фигурами типа stick(***).

## Тесты

Тестирование реализуется с помощью GTest, GMock и CTest. В каталоге /src/tests распологаются тесты основных компонентов библиотеки.
По умолчанию тесты отключены. Для их сборки в корневом CMakeLists.txt требуется установить флаг TEST в положение ON.

    option(TEST "Build tests" ON)

При активации сборки тестов библиотека собирается с -fsanitize=address 

## Документация

Комментарии в коде соответствуют стилю Doxygen, более подробная документация может быть сгенерирована с помощью файла в разделе /doc.

    doxygen ./doc/Doxyfile

![Doc](/resource/Doc.png)


